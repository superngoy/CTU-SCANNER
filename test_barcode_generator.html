<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Generator Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: #f5f5f5;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #fafbfc;
        }
        .barcode-display {
            border: 3px solid #2c3e50;
            border-radius: 8px;
            padding: 10px;
            background: white;
            text-align: center;
            margin: 15px 0;
        }
        .status-pass {
            color: #28a745;
            font-weight: bold;
        }
        .status-fail {
            color: #dc3545;
            font-weight: bold;
        }
        h2 {
            color: #972529;
            border-bottom: 3px solid #972529;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1><i class="fas fa-barcode"></i> Barcode Generator - Functionality Test</h1>
        <p class="text-muted">This page tests the updated barcode generator with Code 39 format, border styling, and download functionality.</p>

        <div class="test-section">
            <h2><i class="fas fa-check-circle"></i> Test 1: Code 39 Barcode Display</h2>
            <p>The barcode below should display in Code 39 format with a prominent rectangular dark border.</p>
            <div class="barcode-display">
                <img id="testBarcode1" src="" alt="Code 39 Barcode Test" style="max-width: 300px; height: auto;">
            </div>
            <p><strong>Test ID:</strong> 2024-TEST-001</p>
            <p id="test1Status">Generating barcode...</p>
        </div>

        <div class="test-section">
            <h2><i class="fas fa-download"></i> Test 2: Download Functionality</h2>
            <p>Click the button below to download the barcode as a PNG file.</p>
            <button class="btn btn-success btn-lg" onclick="testDownload('2024-DOWNLOAD-001', 'Test Person')">
                <i class="fas fa-download me-2"></i>Download Test Barcode
            </button>
            <p id="test2Status" class="mt-3 text-muted">Click the download button to test</p>
        </div>

        <div class="test-section">
            <h2><i class="fas fa-image"></i> Test 3: Border & Styling</h2>
            <p>Verify that barcodes display with proper rectangular borders and styling.</p>
            <div class="row">
                <div class="col-md-6">
                    <h4>Code 39 Format</h4>
                    <div class="barcode-display">
                        <img id="testBarcode2" src="" alt="Code 39 Example" style="max-width: 200px; height: auto;">
                    </div>
                    <p class="text-center text-muted">Code 39 Format - Scan with scanner</p>
                </div>
                <div class="col-md-6">
                    <h4>CSS Applied</h4>
                    <ul>
                        <li>Border: 3px solid #2c3e50 (dark gray)</li>
                        <li>Border Radius: 8px (slightly rounded)</li>
                        <li>Padding: 8px inside border</li>
                        <li>Background: white</li>
                        <li>Box Shadow: 0 4px 8px rgba(0,0,0,0.15)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2><i class="fas fa-gears"></i> Configuration Summary</h2>
            <table class="table table-striped">
                <tr>
                    <td><strong>Barcode Format</strong></td>
                    <td><span class="status-pass">Code 39</span></td>
                </tr>
                <tr>
                    <td><strong>API Endpoint</strong></td>
                    <td><code>api/download_barcode.php</code></td>
                </tr>
                <tr>
                    <td><strong>Border Style</strong></td>
                    <td>3px solid #2c3e50 with rounded corners</td>
                </tr>
                <tr>
                    <td><strong>Barcode Generator API</strong></td>
                    <td>https://barcode.tec-it.com/</td>
                </tr>
                <tr>
                    <td><strong>Download Method</strong></td>
                    <td>Server-side proxy with proper headers</td>
                </tr>
                <tr>
                    <td><strong>Image Format</strong></td>
                    <td>PNG (transparent background)</td>
                </tr>
            </table>
        </div>

        <div class="test-section alert alert-info">
            <h3><i class="fas fa-info-circle"></i> How to Use</h3>
            <ol>
                <li><strong>Navigate to barcode_generator.php</strong> - The main barcode generator page</li>
                <li><strong>Enter an ID</strong> - Student ID, Faculty ID, or Staff ID</li>
                <li><strong>Generate Barcode</strong> - Click "Generate Barcode" button</li>
                <li><strong>Download</strong> - Click the Download button to save as PNG file</li>
                <li><strong>Test Scanner</strong> - Use the "Test with Scanner" button to test with the scanner dashboard</li>
            </ol>
        </div>

        <div class="test-section alert alert-success">
            <h3><i class="fas fa-check"></i> Updates Summary</h3>
            <ul>
                <li>✓ Barcode format: Code 39</li>
                <li>✓ Rectangular border with 3px solid dark gray (#2c3e50)</li>
                <li>✓ Border radius: 8px for smooth edges</li>
                <li>✓ Box shadow for depth and visibility</li>
                <li>✓ Download button uses new API endpoint: <code>api/download_barcode.php</code></li>
                <li>✓ Download functionality enhanced with proper file naming</li>
                <li>✓ Barcode images padded with 8px internal spacing</li>
                <li>✓ White background for contrast</li>
            </ul>
        </div>
    </div>

    <script>
        // Test 1: Generate and display Code 39 barcode
        function generateTestBarcodes() {
            const barcodeUrl1 = `https://barcode.tec-it.com/barcode.ashx?data=2024-TEST-001&code=Code39&dpi=150&print=true&width=350&height=120`;
            const barcodeUrl2 = `https://barcode.tec-it.com/barcode.ashx?data=2024-STYLE-001&code=Code39&dpi=150&print=true&width=250&height=100`;
            
            document.getElementById('testBarcode1').src = barcodeUrl1;
            document.getElementById('testBarcode2').src = barcodeUrl2;
            
            // Update status
            document.getElementById('test1Status').innerHTML = '<span class="status-pass">✓ Barcode generated successfully in Code 39 format</span>';
        }

        // Test 2: Download function
        function testDownload(id, name) {
            const safeName = name.replace(/[^a-zA-Z0-9_-]/g, '_');
            const downloadUrl = `api/download_barcode.php?data=${encodeURIComponent(id)}&name=${encodeURIComponent(safeName)}&width=350&height=120`;
            
            // Create an anchor element and trigger download
            const link = document.createElement('a');
            link.href = downloadUrl;
            link.download = `Barcode_${safeName}.png`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Update status
            document.getElementById('test2Status').innerHTML = '<span class="status-pass">✓ Download initiated - check your downloads folder</span>';
        }

        // Initialize tests on page load
        window.addEventListener('load', function() {
            generateTestBarcodes();
        });
    </script>
</body>
</html>
